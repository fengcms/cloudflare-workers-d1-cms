name = "cloudflare-cms-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# D1 Database binding (top-level for migrations)
[[d1_databases]]
binding = "DB"
database_name = "cms_production"
database_id = "1fcc9f4c-1c2b-4f3d-9f99-3ef03a722b32"
migrations_dir = "drizzle/migrations"

# Development environment (default) - 使用本地模拟
[env.development]
vars = { ENVIRONMENT = "development" }

# D1 Database binding for development (local)
[[env.development.d1_databases]]
binding = "DB"
database_name = "cms_development_local"
database_id = "local"

# R2 Bucket binding for development (local)
[[env.development.r2_buckets]]
binding = "IMAGES"
bucket_name = "cms-images-local"
preview_bucket_name = "cms-images-local"

# KV Namespace binding for development (local)
[[env.development.kv_namespaces]]
binding = "CACHE"
id = "local"

# Production environment - 使用真实的 Cloudflare 资源
[env.production]
vars = { ENVIRONMENT = "production" }

# D1 Database binding for production
[[env.production.d1_databases]]
binding = "DB"
database_name = "cms_production"
database_id = "1fcc9f4c-1c2b-4f3d-9f99-3ef03a722b32"
migrations_dir = "drizzle/migrations"

# R2 Bucket binding for production
[[env.production.r2_buckets]]
binding = "IMAGES"
bucket_name = "cms-images"

# KV Namespace binding for production
[[env.production.kv_namespaces]]
binding = "CACHE"
id = "75e3b34e431d4154b26fe728db111b36"
